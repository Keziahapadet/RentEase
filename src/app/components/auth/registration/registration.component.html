<div class="register-page">
  <div class="register-card">
    <!-- Logo + Title -->
    <div class="logo-title">
      <img src="/images/logo.png" alt="RentEase Logo" />
      <h2>Get Started</h2>
    </div>

    <!-- Error / Success -->
    <div *ngIf="errorMessage" class="alert-error">{{ errorMessage }}</div>
    <div *ngIf="successMessage" class="alert-success">{{ successMessage }}</div>

    <!-- Registration Form -->
    <form (ngSubmit)="onSubmit()" #registrationForm="ngForm" novalidate>

      <!-- Role -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Role</mat-label>
        <mat-select [(ngModel)]="formData.role" name="role" (selectionChange)="onRoleChange()" [disabled]="isInvitation" required>
          <mat-option value="tenant">Tenant</mat-option>
          <mat-option value="landlord">Landlord</mat-option>
          <mat-option value="caretaker">Caretaker</mat-option>
          <mat-option value="business">Business</mat-option>
          <mat-option value="admin">Admin</mat-option>
        </mat-select>
      </mat-form-field>

      <!-- Property info for invited tenant/caretaker -->
      <mat-form-field *ngIf="isInvitation && (formData.role === 'tenant' || formData.role === 'caretaker')" appearance="outline" class="full-width">
        <mat-label>Property / Unit</mat-label>
        <input matInput [value]="formData.propertyName" readonly />
      </mat-form-field>

      <!-- User Name -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>User Name</mat-label>
        <input matInput type="text" [(ngModel)]="formData.userName" name="fullName" required />
      </mat-form-field>

      <!-- Email -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Email</mat-label>
        <input matInput type="email" [(ngModel)]="formData.email" name="email" [readonly]="isInvitation" required />
      </mat-form-field>

      <!-- Phone -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Phone Number</mat-label>
        <input matInput type="tel" placeholder="+254 700 000 000" [(ngModel)]="formData.phone" name="phone" required />
      </mat-form-field>

      <!-- Password -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Password</mat-label>
        <input matInput [type]="showPassword ? 'text' : 'password'" [(ngModel)]="formData.password" name="password" required />
        <button mat-icon-button matSuffix type="button" (click)="togglePasswordVisibility('password')">
          <mat-icon>{{ showPassword ? 'visibility' : 'visibility_off' }}</mat-icon>
        </button>
      </mat-form-field>

      <!-- Confirm Password -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Confirm Password</mat-label>
        <input matInput [type]="showConfirmPassword ? 'text' : 'password'" [(ngModel)]="formData.confirmPassword" name="confirmPassword" required />
        <button mat-icon-button matSuffix type="button" (click)="togglePasswordVisibility('confirm')">
          <mat-icon>{{ showConfirmPassword ? 'visibility' : 'visibility_off' }}</mat-icon>
        </button>
      </mat-form-field>

      <!-- Admin Access Code -->
      <mat-form-field *ngIf="formData.role === 'admin'" appearance="outline" class="full-width">
        <mat-label>Admin Access Code</mat-label>
        <input matInput type="text" [(ngModel)]="formData.accessCode" name="accessCode" />
      </mat-form-field>

      <div class="terms-container">
  <mat-checkbox [(ngModel)]="agreedToTerms" name="agreedToTerms">
    I agree to the 
    <span class="clickable-text" (click)="navigateToTerms()">Terms and Conditions</span> and 
    <span class="clickable-text" (click)="navigateToPrivacy()">Privacy Policy</span>.
  </mat-checkbox>
</div>

<!-- Display validation error -->
<div *ngIf="errorMessage" class="error-message">
  {{ errorMessage }}
</div>

      <!-- Submit -->
      <button mat-raised-button color="primary" class="full-width submit-btn" [disabled]="isLoading || !registrationForm.valid || !agreedToTerms">
        {{ isLoading ? 'Creating Account...' : 'Create Account' }}
      </button>
    </form>

    <!-- Login Link -->
    <p class="login-link">
      Already have an account? <a (click)="navigateToLogin()">Login</a>
    </p>
  </div>
</div>
