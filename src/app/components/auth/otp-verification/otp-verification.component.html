<div class="otp-page">
  <div class="otp-card">
    <div class="logo-title">
      <img src="/images/logo.png" alt="RentEase Logo" />
      <h2>OTP Verification</h2>
    </div>

    <p class="subtitle">
      Enter the 7-character code sent to your email 
      <span *ngIf="email"><strong>({{ getDisplayEmail() }})</strong></span>
    </p>

    <form [formGroup]="otpForm" (ngSubmit)="onSubmit()">
      <div class="otp-container">
        <div class="otp-inputs" formGroupName="otpFields">
          <mat-form-field appearance="fill" *ngFor="let field of otpFields; let i = index" class="otp-input">
            <input
              matInput
              type="text"
              [formControlName]="field"
              [maxlength]="1"
              (input)="onOtpInput($event, i)"
              (keydown)="onOtpKeyDown($event, i)"
              (paste)="onOtpPaste($event)"
              autocomplete="one-time-code"
              [placeholder]="i === 0 ? 'A' : '0'"
              [attr.inputmode]="i === 0 ? 'text' : 'numeric'"
            />
          </mat-form-field>
        </div>

        <mat-error *ngIf="showOtpError" class="otp-error">
          {{ otpErrorMessage }}
        </mat-error>
        
        <p class="helper-text">Format: Letter + 6 numbers (e.g., R123456)</p>
      </div>

      <button
        mat-raised-button
        color="primary"
        class="full-width verify-btn"
        type="submit"
        [disabled]="isLoading || !isOtpComplete()"
      >
        <div class="button-content">
          <mat-spinner diameter="20" *ngIf="isLoading" class="button-spinner"></mat-spinner>
          {{ isLoading ? 'Verifying...' : 'Verify OTP' }}
        </div>
      </button>
    </form>

    <div class="resend-section">
      <p class="resend-text">Didn't receive the code?</p>
      <button
        mat-stroked-button
        color="primary"
        (click)="resendOtp()"
        [disabled]="!canResend || isResending"
        type="button"
      >
        <div class="resend-button-content">
          <mat-spinner diameter="16" *ngIf="isResending" class="spinner-icon"></mat-spinner>
          <mat-icon *ngIf="!isResending && canResend">refresh</mat-icon>
          {{
            isResending
              ? 'Resending...'
              : canResend
                ? 'Resend OTP'
                : 'Resend in ' + resendTimer + 's'
          }}
        </div>
      </button>
    </div>

    <div class="help-section">
      <p class="help-text">
        <mat-icon>info</mat-icon>
        Check your spam folder if you don't see the email
      </p>
      <p class="help-text">
        <mat-icon>timer</mat-icon>
        Code expires in 10 minutes
      </p>
    </div>

    <div class="back-links">
      <a (click)="navigateToForgotPassword()">
        <mat-icon>arrow_back</mat-icon>
        Back to Forgot Password
      </a>
      <a (click)="navigateToLogin()">
        <mat-icon>login</mat-icon>
        Back to Login
      </a>
    </div>
  </div>
</div>