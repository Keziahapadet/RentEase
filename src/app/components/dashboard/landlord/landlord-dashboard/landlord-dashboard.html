<div class="dashboard-container">
  <div class="mobile-menu-overlay" [class.active]="isMobileMenuOpen" (click)="closeMobileMenu()"></div>
  
  <nav class="sidebar" [class.mobile-open]="isMobileMenuOpen">
    <div class="sidebar-header">
      <div class="logo" (click)="navigateToSection('dashboard')">
        <img src="/images/logo.png" alt="RentEase Logo" class="logo-image">
      </div>
    </div>

    <div class="user-section">
      <div class="user-info" (click)="viewProfile()">
        <div class="user-avatar">
          <img *ngIf="profileImage" [src]="profileImage" alt="Profile" class="avatar-image">
          <div *ngIf="!profileImage" class="avatar-placeholder">
            <mat-icon>account_circle</mat-icon>
          </div>
        </div>
        <div class="user-details">
          <span class="user-name">{{ userDisplayName }}</span>
          <span class="user-role">{{ userRole }}</span>
        </div>
      </div>

      <div class="profile-dropdown-trigger" (click)="toggleProfileMenu(); $event.stopPropagation()">
        <mat-icon class="dropdown-chevron" [class.rotated]="isProfileMenuOpen">
          expand_more
        </mat-icon>
      </div>

      <div class="profile-dropdown-menu" *ngIf="isProfileMenuOpen">
        <div class="profile-menu-actions">
          <button class="profile-action-btn" (click)="editProfile(); $event.stopPropagation()">
            <mat-icon>edit</mat-icon>
            <span>Edit Profile</span>
          </button>

          <div class="menu-divider"></div>

          <button class="profile-action-btn logout-btn" (click)="logout(); $event.stopPropagation()">
            <mat-icon>logout</mat-icon>
            <span>Logout</span>
          </button>
        </div>
      </div>
    </div>

    <div class="nav-menu">
      <div class="nav-item" 
           [class.active]="isNavActive('dashboard')" 
           (click)="navigateToSection('dashboard')">
        <mat-icon class="nav-icon">dashboard</mat-icon>
        <span>Dashboard</span>
      </div>

      <div class="nav-section">
        <div class="nav-item expandable" 
             [class.active]="isParentActive('financials')"
             (click)="toggleMenu('financials')">
          <mat-icon class="nav-icon">payments</mat-icon>
          <span>Financials</span>
          <mat-icon class="chevron" [class.expanded]="expandedMenus.financials">
            chevron_right
          </mat-icon>
        </div>
        <div *ngIf="expandedMenus.financials" class="sub-menu">
          <div class="sub-item" 
               [class.active]="isSubItemActive('financials')" 
               (click)="navigateToSection('financials')">
            <mat-icon class="sub-icon">dashboard</mat-icon>
            <span>Overview</span>
          </div>
          <div class="sub-item" 
               [class.active]="isSubItemActive('invoices')" 
               (click)="navigateToSection('invoices')">
            <mat-icon class="sub-icon">receipt</mat-icon>
            <span>Invoices</span>
          </div>
          <div class="sub-item" 
               [class.active]="isSubItemActive('payments')" 
               (click)="navigateToSection('payments')">
            <mat-icon class="sub-icon">credit_card</mat-icon>
            <span>Payments</span>
          </div>
          <div class="sub-item" 
               [class.active]="isSubItemActive('expenses')" 
               (click)="navigateToSection('expenses')">
            <mat-icon class="sub-icon">trending_down</mat-icon>
            <span>Expenses</span>
          </div>
        </div>
      </div>

      <div class="nav-item" 
           [class.active]="isNavActive('tenants')" 
           (click)="navigateToTenants()">
        <mat-icon class="nav-icon">groups</mat-icon>
        <span>Tenants</span>
      </div>

      <div class="nav-item" 
           [class.active]="isNavActive('properties')" 
           (click)="navigateToSection('properties')">
        <mat-icon class="nav-icon">apartment</mat-icon>
        <span>Properties</span>
      </div>

      <div class="nav-item" 
           [class.active]="isNavActive('messages')" 
           (click)="navigateToSection('messages')">
        <mat-icon class="nav-icon">message</mat-icon>
        <span>Communication</span>
        <span class="notification-dot">3</span>
      </div>

      <div class="nav-item" 
           [class.active]="isNavActive('documents')" 
           (click)="navigateToSection('documents')">
        <mat-icon class="nav-icon">description</mat-icon>
        <span>Documents</span>
      </div>

      <div class="nav-item" 
           [class.active]="isNavActive('marketplace')" 
           (click)="navigateToSection('marketplace')">
        <mat-icon class="nav-icon">storefront</mat-icon>
        <span>Marketplace</span>
      </div>

      <div class="nav-item" 
           [class.active]="isNavActive('reviews')" 
           (click)="navigateToSection('reviews')">
        <mat-icon class="nav-icon">star_rate</mat-icon>
        <span>Reviews & Ratings</span>
      </div>

      <div class="nav-item" 
           [class.active]="isNavActive('reports')" 
           (click)="navigateToSection('reports')">
        <mat-icon class="nav-icon">analytics</mat-icon>
        <span>Reports</span>
      </div>

      <div class="nav-section">
        <div class="nav-item expandable" 
             [class.active]="isParentActive('settings')"
             (click)="toggleMenu('settings')">
          <mat-icon class="nav-icon">settings</mat-icon>
          <span>Settings</span>
          <mat-icon class="chevron" [class.expanded]="expandedMenus.settings">
            chevron_right
          </mat-icon>
        </div>
        <div *ngIf="expandedMenus.settings" class="sub-menu">
          <div class="sub-item" 
               [class.active]="isSubItemActive('general')" 
               (click)="navigateToSection('general')">
            <mat-icon class="sub-icon">tune</mat-icon>
            <span>General</span>
          </div>
          <div class="sub-item" 
               [class.active]="isSubItemActive('account')" 
               (click)="navigateToSection('account')">
            <mat-icon class="sub-icon">person</mat-icon>
            <span>Account Info</span>
          </div>
          <div class="sub-item" 
               [class.active]="isSubItemActive('alerts')" 
               (click)="navigateToSection('alerts')">
            <mat-icon class="sub-icon">notifications</mat-icon>
            <span>Alerts</span>
          </div>
          <div class="sub-item" 
               [class.active]="isSubItemActive('security')" 
               (click)="navigateToSection('security')">
            <mat-icon class="sub-icon">lock</mat-icon>
            <span>Security</span>
          </div>
        </div>
      </div>
    </div>

    <div class="sidebar-footer">
      <div class="nav-item">
        <mat-icon>help</mat-icon>
        <span>Help & Support</span>
      </div>
    </div>
  </nav>

  <main class="main-content">
    <button class="mobile-menu-btn" (click)="toggleMobileMenu()">
      <mat-icon>menu</mat-icon>
    </button>

    <div *ngIf="currentSection === 'dashboard'" class="dashboard-home">
      <div class="content-header">
        <div class="header-left">
          <h1>Welcome back, {{ userDisplayName }}!</h1>
          <p>Manage your properties and track performance</p>
        </div>
        <div class="header-actions">
          <button class="btn-primary" (click)="addNewProperty()">
            <mat-icon>add</mat-icon>
            Add Property
          </button>
          <button class="notification-btn" (click)="viewNotifications()">
            <mat-icon>notifications</mat-icon>
            <span class="notification-badge">3</span>
          </button>
        </div>
      </div>

      <div class="dashboard-content">
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-header">
              <span class="stat-title">Total Properties</span>
              <div class="stat-icon primary">
                <mat-icon>apartment</mat-icon>
              </div>
            </div>
            <div class="stat-value">{{ totalProperties }}</div>
            <div class="stat-change positive">
              <mat-icon>trending_up</mat-icon>
              <span>+2 this month</span>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-header">
              <span class="stat-title">Active Tenants</span>
              <div class="stat-icon success">
                <mat-icon>groups</mat-icon>
              </div>
            </div>
            <div class="stat-value">{{ activeTenants }}</div>
            <div class="stat-change positive">
              <mat-icon>trending_up</mat-icon>
              <span>+5 this month</span>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-header">
              <span class="stat-title">Monthly Revenue</span>
              <div class="stat-icon warning">
                <mat-icon>attach_money</mat-icon>
              </div>
            </div>
            <div class="stat-value">{{ monthlyRevenue }}</div>
            <div class="stat-change positive">
              <mat-icon>trending_up</mat-icon>
              <span>+8.2% from last month</span>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-header">
              <span class="stat-title">Vacant Units</span>
              <div class="stat-icon danger">
                <mat-icon>meeting_room</mat-icon>
              </div>
            </div>
            <div class="stat-value">{{ vacantUnits }}</div>
            <div class="stat-change negative">
              <mat-icon>trending_down</mat-icon>
              <span>2 new vacancies</span>
            </div>
          </div>
        </div>

        <div class="content-grid">
          <div class="content-card">
            <div class="card-header">
              <h3>Recent Activity</h3>
              <p>Latest updates from your properties</p>
            </div>
            <div class="card-content">
              <div class="activity-list">
                <div class="activity-item" *ngFor="let activity of recentActivities">
                  <div class="activity-icon">
                    <mat-icon [style.color]="activity.color">{{ activity.icon }}</mat-icon>
                  </div>
                  <div class="activity-details">
                    <div class="activity-text">{{ activity.text }}</div>
                    <div class="activity-time">{{ activity.time }}</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="content-card">
            <div class="card-header">
              <h3>Quick Stats</h3>
              <p>Key performance indicators</p>
            </div>
            <div class="card-content">
              <div class="quick-stats">
                <div class="quick-stat" *ngFor="let stat of quickStats">
                  <div class="quick-stat-icon">
                    <mat-icon>{{ stat.icon }}</mat-icon>
                  </div>
                  <div class="quick-stat-info">
                    <div class="stat-amount">{{ stat.amount }}</div>
                    <div class="stat-label">{{ stat.label }}</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <router-outlet></router-outlet>
  </main>
</div>