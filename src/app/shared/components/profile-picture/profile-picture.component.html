<div class="profile-picture-container" [class]="size">
  <div class="profile-image-wrapper">
    <div class="profile-image" [class.has-image]="imageUrl && !isDefaultAvatar()" [class.editable]="editable">
      
     
      <div *ngIf="loading" class="loading-state">
        <mat-icon class="loading-icon">refresh</mat-icon>
        <span class="loading-text">Loading...</span>
      </div>

   
      <div *ngIf="uploading" class="uploading-state">
        <mat-icon class="uploading-icon">cloud_upload</mat-icon>
        <span class="uploading-text">Uploading...</span>
      </div>

      <img 
        *ngIf="imageUrl && !isDefaultAvatar() && !loading && !uploading" 
        [src]="imageUrl" 
        [alt]="getUserName()" 
        (error)="onImageError()"
        class="profile-img">
      
    
      <div *ngIf="(isDefaultAvatar() || !imageUrl) && !loading && !uploading" 
           class="default-avatar" [class]="getUserRole()">
        <span class="initials">{{getInitials()}}</span>
      </div>
      
     
      <div class="overlay-actions" *ngIf="editable && !uploading && !loading">
        <input 
          type="file" 
          #fileInput 
          (change)="onFileSelected($event)" 
          accept="image/jpeg,image/png,image/gif,image/webp" 
          hidden>
        
        <button class="btn-action btn-change" (click)="fileInput.click()" matTooltip="Change picture">
          <mat-icon>camera_alt</mat-icon>
        </button>
        
        <button 
          class="btn-action btn-delete" 
          (click)="deletePicture()" 
          *ngIf="!isDefaultAvatar()"
          matTooltip="Delete picture">
          <mat-icon>delete</mat-icon>
        </button>
      </div>
    </div>

 
    <div class="verified-badge" *ngIf="userProfile?.verified">
      <mat-icon>verified</mat-icon>
    </div>
  </div>


  <div class="user-info" *ngIf="showName && userProfile">
    <h3 class="user-name">{{getUserName()}}</h3>
    <span class="user-role" *ngIf="showRole">{{getRoleDisplay()}}</span>
    <span class="user-status" [class.verified]="userProfile.verified" *ngIf="userProfile.verified">
      <mat-icon>check_circle</mat-icon>
      Verified
    </span>
  </div>
</div>